var salvattore=function(e,t,n){"use strict";var a={},i=[],r=[],s=[],l=function(e,t,n){e.dataset?e.dataset[t]=n:e.setAttribute("data-"+t,n)};return a.obtainGridSettings=function(t){var n=e.getComputedStyle(t,":before"),a=n.getPropertyValue("content").slice(1,-1),i=a.match(/^\s*(\d+)(?:\s?\.(.+))?\s*$/),r=1,s=[];return i?(r=i[1],s=i[2],s=s?s.split("."):["column"]):(i=a.match(/^\s*\.(.+)\s+(\d+)\s*$/),i&&(s=i[1],r=i[2],r&&(r=r.split(".")))),{numberOfColumns:r,columnClasses:s}},a.addColumns=function(e,n){for(var i,r=a.obtainGridSettings(e),s=r.numberOfColumns,o=r.columnClasses,c=new Array(+s),d=t.createDocumentFragment(),m=s;0!==m--;)i="[data-columns] > *:nth-child("+s+"n-"+m+")",c.push(n.querySelectorAll(i));c.forEach(function(e){var n=t.createElement("div"),a=t.createDocumentFragment();n.className=o.join(" "),Array.prototype.forEach.call(e,function(e){a.appendChild(e)}),n.appendChild(a),d.appendChild(n)}),e.appendChild(d),l(e,"columns",s)},a.removeColumns=function(n){var a=t.createRange();a.selectNodeContents(n);var i=Array.prototype.filter.call(a.extractContents().childNodes,function(t){return t instanceof e.HTMLElement}),r=i.length,s=i[0].childNodes.length,o=new Array(s*r);Array.prototype.forEach.call(i,function(e,t){Array.prototype.forEach.call(e.children,function(e,n){o[n*r+t]=e})});var c=t.createElement("div");return l(c,"columns",0),o.filter(function(e){return!!e}).forEach(function(e){c.appendChild(e)}),c},a.recreateColumns=function(t){e.requestAnimationFrame(function(){a.addColumns(t,a.removeColumns(t));var e=new CustomEvent("columnsChange");t.dispatchEvent(e)})},a.mediaQueryChange=function(e){e.matches&&Array.prototype.forEach.call(i,a.recreateColumns)},a.getCSSRules=function(e){var t;try{t=e.sheet.cssRules||e.sheet.rules}catch(n){return[]}return t||[]},a.getStylesheets=function(){var e=Array.prototype.slice.call(t.querySelectorAll("style"));return e.forEach(function(t,n){"text/css"!==t.type&&""!==t.type&&e.splice(n,1)}),Array.prototype.concat.call(e,Array.prototype.slice.call(t.querySelectorAll("link[rel='stylesheet']")))},a.mediaRuleHasColumnsSelector=function(e){var t,n;try{t=e.length}catch(a){t=0}for(;t--;)if(n=e[t],n.selectorText&&n.selectorText.match(/\[data-columns\](.*)::?before$/))return!0;return!1},a.scanMediaQueries=function(){var t=[];if(e.matchMedia){a.getStylesheets().forEach(function(e){Array.prototype.forEach.call(a.getCSSRules(e),function(e){try{e.media&&e.cssRules&&a.mediaRuleHasColumnsSelector(e.cssRules)&&t.push(e)}catch(n){}})});var n=r.filter(function(e){return-1===t.indexOf(e)});s.filter(function(e){return-1!==n.indexOf(e.rule)}).forEach(function(e){e.mql.removeListener(a.mediaQueryChange)}),s=s.filter(function(e){return-1===n.indexOf(e.rule)}),t.filter(function(e){return-1==r.indexOf(e)}).forEach(function(t){var n=e.matchMedia(t.media.mediaText);n.addListener(a.mediaQueryChange),s.push({rule:t,mql:n})}),r.length=0,r=t}},a.rescanMediaQueries=function(){a.scanMediaQueries(),Array.prototype.forEach.call(i,a.recreateColumns)},a.nextElementColumnIndex=function(e,t){var n,a,i,r=e.children,s=r.length,l=0,o=0;for(i=0;s>i;i++)n=r[i],a=n.children.length+(t[i].children||t[i].childNodes).length,0===l&&(l=a),l>a&&(o=i,l=a);return o},a.createFragmentsList=function(e){for(var n=new Array(e),a=0;a!==e;)n[a]=t.createDocumentFragment(),a++;return n},a.appendElements=function(e,t){var n=e.children,i=n.length,r=a.createFragmentsList(i);Array.prototype.forEach.call(t,function(t){var n=a.nextElementColumnIndex(e,r);r[n].appendChild(t)}),Array.prototype.forEach.call(n,function(e,t){e.appendChild(r[t])})},a.prependElements=function(e,n){var i=e.children,r=i.length,s=a.createFragmentsList(r),l=r-1;n.forEach(function(e){var t=s[l];t.insertBefore(e,t.firstChild),0===l?l=r-1:l--}),Array.prototype.forEach.call(i,function(e,t){e.insertBefore(s[t],e.firstChild)});for(var o=t.createDocumentFragment(),c=n.length%r;0!==c--;)o.appendChild(e.lastChild);e.insertBefore(o,e.firstChild)},a.registerGrid=function(n){if("none"!==e.getComputedStyle(n).display){var r=t.createRange();r.selectNodeContents(n);var s=t.createElement("div");s.appendChild(r.extractContents()),l(s,"columns",0),a.addColumns(n,s),i.push(n)}},a.init=function(){var e=t.createElement("style");e.innerHTML="[data-columns]::before{display:block;visibility:hidden;position:absolute;font-size:1px;}",t.head.appendChild(e);var n=t.querySelectorAll("[data-columns]");Array.prototype.forEach.call(n,a.registerGrid),a.scanMediaQueries()},a.init(),{appendElements:a.appendElements,prependElements:a.prependElements,registerGrid:a.registerGrid,recreateColumns:a.recreateColumns,rescanMediaQueries:a.rescanMediaQueries,init:a.init,append_elements:a.appendElements,prepend_elements:a.prependElements,register_grid:a.registerGrid,recreate_columns:a.recreateColumns,rescan_media_queries:a.rescanMediaQueries}}(window,window.document);
