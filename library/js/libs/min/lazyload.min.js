!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.LazyLoad=t()}(this,function(){function e(){v||(h={elements_selector:"img",container:window,threshold:300,throttle:50,data_src:"original",data_srcset:"original-set",class_loading:"loading",class_loaded:"loaded",skip_invisible:!0,callback_load:null,callback_error:null,callback_set:null,callback_processed:null},p=!!window.addEventListener,g=!!window.attachEvent,m=!!document.body.classList,v=!0)}function t(e,t,n){return p?void e.addEventListener(t,n):void(g&&(e.attachEvent("on"+t,function(e){return function(){n.call(e,window.event)}}(e)),e=null))}function n(e,t,n){return p?void e.removeEventListener(t,n):void(g&&e.detachEvent("on"+t,n))}function r(e,t,n){function r(){return window.innerWidth||f.documentElement.clientWidth||document.body.clientWidth}function i(){return window.innerHeight||f.documentElement.clientHeight||document.body.clientHeight}function o(e){return e.getBoundingClientRect().top+d-f.documentElement.clientTop}function a(e){return e.getBoundingClientRect().left+h-f.documentElement.clientLeft}function s(){var r;return r=t===window?i()+d:o(t)+t.offsetHeight,r<=o(e)-n}function l(){var i;return i=t===window?r()+window.pageXOffset:a(t)+r(),i<=a(e)-n}function u(){var r;return r=t===window?d:o(t),r>=o(e)+n+e.offsetHeight}function c(){var r;return r=t===window?h:a(t),r>=a(e)+n+e.offsetWidth}var f,d,h;return f=e.ownerDocument,d=window.pageYOffset||f.body.scrollTop,h=window.pageXOffset||f.body.scrollLeft,!(s()||u()||l()||c())}function i(){var e=new Date;return e.getTime()}function o(e,t){var n,r={};for(n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);for(n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return r}function a(e){try{return Array.prototype.slice.call(e)}catch(i){var t,n=[],r=e.length;for(t=0;t<r;t++)n.push(e[t]);return n}}function s(e,t){return m?void e.classList.add(t):void(e.className+=(e.className?" ":"")+t)}function l(e,t){return m?void e.classList.remove(t):void(e.className=e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,""))}function u(e,t){var n=e.parentElement;if("PICTURE"===n.tagName)for(var r=0;r<n.children.length;r++){var i=n.children[r];if("SOURCE"===i.tagName){var o=i.getAttribute("data-"+t);o&&i.setAttribute("srcset",o)}}}function c(e,t,n){var r=e.tagName,i=e.getAttribute("data-"+n);if("IMG"===r){u(e,t);var o=e.getAttribute("data-"+t);return o&&e.setAttribute("srcset",o),void(i&&e.setAttribute("src",i))}return"IFRAME"===r?void(i&&e.setAttribute("src",i)):void(e.style.backgroundImage="url("+i+")")}function f(e,t){return function(){return e.apply(t,arguments)}}function d(n){e(),this._settings=o(h,n),this._queryOriginNode=this._settings.container===window?document:this._settings.container,this._previousLoopTime=0,this._loopTimeout=null,this._handleScrollFn=f(this.handleScroll,this),t(window,"resize",this._handleScrollFn),this.update()}var h,p,g,m,v=!1;return d.prototype._showOnAppear=function(e){function r(){null!==i&&(i.callback_load&&i.callback_load(e),l(e,i.class_loading),s(e,i.class_loaded),n(e,"load",r))}var i=this._settings;"IMG"!==e.tagName&&"IFRAME"!==e.tagName||(t(e,"load",r),t(e,"error",function(){n(e,"load",r),l(e,i.class_loading),i.callback_error&&i.callback_error(e)}),s(e,i.class_loading)),c(e,i.data_srcset,i.data_src),i.callback_set&&i.callback_set(e)},d.prototype._loopThroughElements=function(){var e,t,n=this._settings,i=this._elements,o=i?i.length:0,a=[];for(e=0;e<o;e++)t=i[e],n.skip_invisible&&null===t.offsetParent||r(t,n.container,n.threshold)&&(this._showOnAppear(t),a.push(e),t.wasProcessed=!0);for(;a.length>0;)i.splice(a.pop(),1),n.callback_processed&&n.callback_processed(i.length);0===o&&this._stopScrollHandler()},d.prototype._purgeElements=function(){var e,t,n=this._elements,r=n.length,i=[];for(e=0;e<r;e++)t=n[e],t.wasProcessed&&i.push(e);for(;i.length>0;)n.splice(i.pop(),1)},d.prototype._startScrollHandler=function(){this._isHandlingScroll||(this._isHandlingScroll=!0,t(this._settings.container,"scroll",this._handleScrollFn))},d.prototype._stopScrollHandler=function(){this._isHandlingScroll&&(this._isHandlingScroll=!1,n(this._settings.container,"scroll",this._handleScrollFn))},d.prototype.handleScroll=function(){var e,t,n;this._settings&&(t=i(),n=this._settings.throttle,0!==n?(e=n-(t-this._previousLoopTime),e<=0||e>n?(this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._previousLoopTime=t,this._loopThroughElements()):this._loopTimeout||(this._loopTimeout=setTimeout(f(function(){this._previousLoopTime=i(),this._loopTimeout=null,this._loopThroughElements()},this),e))):this._loopThroughElements())},d.prototype.update=function(){this._elements=a(this._queryOriginNode.querySelectorAll(this._settings.elements_selector)),this._purgeElements(),this._loopThroughElements(),this._startScrollHandler()},d.prototype.destroy=function(){n(window,"resize",this._handleScrollFn),this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._stopScrollHandler(),this._elements=null,this._queryOriginNode=null,this._settings=null},d});
