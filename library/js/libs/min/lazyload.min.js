!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.LazyLoad=e()}(this,function(){function t(){f||(h={elements_selector:"img",container:window,threshold:300,throttle:50,data_src:"original",data_srcset:"original-set",class_loading:"loading",class_loaded:"loaded",skip_invisible:!0,show_while_loading:!1,callback_load:null,callback_set:null,callback_processed:null,placeholder:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},_=!!window.addEventListener,p=!!window.attachEvent,g=!!document.body.classList,f=!0)}function e(t,e,o){return _?void t.addEventListener(e,o):void(p&&(t.attachEvent("on"+e,function(t){return function(){o.call(t,window.event)}}(t)),t=null))}function o(t,e,o){return _?void t.removeEventListener(e,o):void(p&&t.detachEvent("on"+e,o))}function n(t,e,o){function n(){return window.innerWidth||u.documentElement.clientWidth||document.body.clientWidth}function i(){return window.innerHeight||u.documentElement.clientHeight||document.body.clientHeight}function l(t){return t.getBoundingClientRect().top+h-u.documentElement.clientTop}function s(t){return t.getBoundingClientRect().left+_-u.documentElement.clientLeft}function r(){var n;return n=e===window?i()+h:l(e)+e.offsetHeight,n<=l(t)-o}function a(){var i;return i=e===window?n()+window.pageXOffset:s(e)+n(),i<=s(t)-o}function c(){var n;return n=e===window?h:l(e),n>=l(t)+o+t.offsetHeight}function d(){var n;return n=e===window?_:s(e),n>=s(t)+o+t.offsetWidth}var u,h,_;return u=t.ownerDocument,h=window.pageYOffset||u.body.scrollTop,_=window.pageXOffset||u.body.scrollLeft,!(r()||c()||a()||d())}function i(){var t=new Date;return t.getTime()}function l(t,e){var o,n={};for(o in t)t.hasOwnProperty(o)&&(n[o]=t[o]);for(o in e)e.hasOwnProperty(o)&&(n[o]=e[o]);return n}function s(t){try{return Array.prototype.slice.call(t)}catch(e){var o,n=[],i=t.length;for(o=0;i>o;o++)n.push(t[o]);return n}}function r(t,e){return g?void t.classList.add(e):void(t.className+=(t.className?" ":"")+e)}function a(t,e){return g?void t.classList.remove(e):void(t.className=t.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,""))}function c(t,e,o,n){var i=e.getAttribute("data-"+o),l=e.getAttribute("data-"+n);i&&t.setAttribute("srcset",i),l&&t.setAttribute("src",l)}function d(t,e){return function(){return t.apply(e,arguments)}}function u(o){t(),this._settings=l(h,o),this._queryOriginNode=this._settings.container===window?document:this._settings.container,this._previousLoopTime=0,this._loopTimeout=null,this._handleScrollFn=d(this.handleScroll,this),e(window,"resize",this._handleScrollFn),this.update()}var h,_,p,g,f=!1;return u.prototype._showOnLoad=function(t){function n(){null!==l&&(l.callback_load&&l.callback_load(t),c(t,t,l.data_srcset,l.data_src),l.callback_set&&l.callback_set(t),a(t,l.class_loading),r(t,l.class_loaded),o(i,"load",n))}var i,l=this._settings;t.getAttribute("src")||t.setAttribute("src",l.placeholder),i=document.createElement("img"),e(i,"load",n),r(t,l.class_loading),c(i,t,l.data_srcset,l.data_src)},u.prototype._showOnAppear=function(t){function n(){null!==i&&(i.callback_load&&i.callback_load(t),a(t,i.class_loading),r(t,i.class_loaded),o(t,"load",n))}var i=this._settings;e(t,"load",n),r(t,i.class_loading),c(t,t,i.data_srcset,i.data_src),i.callback_set&&i.callback_set(t)},u.prototype._loopThroughElements=function(){var t,e,o=this._settings,i=this._elements,l=i?i.length:0,s=[];for(t=0;l>t;t++)e=i[t],o.skip_invisible&&null===e.offsetParent||n(e,o.container,o.threshold)&&(o.show_while_loading?this._showOnAppear(e):this._showOnLoad(e),s.push(t),e.wasProcessed=!0);for(;s.length>0;)i.splice(s.pop(),1),o.callback_processed&&o.callback_processed(i.length);0===l&&this._stopScrollHandler()},u.prototype._purgeElements=function(){var t,e,o=this._elements,n=o.length,i=[];for(t=0;n>t;t++)e=o[t],e.wasProcessed&&i.push(t);for(;i.length>0;)o.splice(i.pop(),1)},u.prototype._startScrollHandler=function(){this._isHandlingScroll||(this._isHandlingScroll=!0,e(this._settings.container,"scroll",this._handleScrollFn))},u.prototype._stopScrollHandler=function(){this._isHandlingScroll&&(this._isHandlingScroll=!1,o(this._settings.container,"scroll",this._handleScrollFn))},u.prototype.handleScroll=function(){var t,e,o;this._settings&&(e=i(),o=this._settings.throttle,0!==o?(t=o-(e-this._previousLoopTime),0>=t||t>o?(this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._previousLoopTime=e,this._loopThroughElements()):this._loopTimeout||(this._loopTimeout=setTimeout(d(function(){this._previousLoopTime=i(),this._loopTimeout=null,this._loopThroughElements()},this),t))):this._loopThroughElements())},u.prototype.update=function(){this._elements=s(this._queryOriginNode.querySelectorAll(this._settings.elements_selector)),this._purgeElements(),this._loopThroughElements(),this._startScrollHandler()},u.prototype.destroy=function(){o(window,"resize",this._handleScrollFn),this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._stopScrollHandler(),this._elements=null,this._queryOriginNode=null,this._settings=null},u});
